const jwt =require("jsonwebtoken")

const mw=function(req,res,next){
    let id=req.params.userId
try{ 
    let token = req.headers['my-auth-token'] 
    if(!token) return res.send({msg: 'Token is required to verify log in credentials. Please send it.'}) 
    let tokenValidity = jwt.verify(token, "functionup-uranium")
    if(tokenValidity.userId !== id) return res.send({msg: "This user hasn't been Authorised"}) 
    next()
}
    
    catch(err){
        console.log(err.message)
        res.status(401).send({status: false, msg: 'invalid token, unable to verify session. Please re-log in.'}) 
    }
}


module.exports ={mw}